<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Let&#39;s Encrypt å…è´¹å¥½ç”¨çš„ HTTPS è¯ä¹¦ ï¼ˆRaspberry piï¼‰ | ICE.GS</title><meta name="description" content="A geeker blog."><meta name="keywords" content="hexo,theme,icer,ggice"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="Letâ€™s Encrypt è¢«ç§°ä¸ºä¸ªäººHTTPSçš„æœ€ä½³è§£å†³æ–¹æ¡ˆï¼Œå¾—åˆ°Mozillaã€CISCOã€Chromeã€Facebook ç­‰ä¼—å¤šä¼ä¸šç»„ç»‡çš„æ”¯æŒã€‚Letâ€™s Encrypt ä¹Ÿæä¾›ä¸€å¥—ç®€å•çš„HTTPSé…ç½®æ–¹æ¡ˆã€‚æœ¬æ–‡ç®€å•åˆ†äº«ä¸‹å®‰è£… Letâ€™s Encrypt HTTPSè¯ä¹¦è¿‡ç¨‹ï¼Œæœºå™¨ä¸ºRaspberry pi 3 ï¼Œç³»ç»Ÿä¸º Debian7ï¼ŒæœåŠ¡å™¨è½¯ä»¶ä¸ºNginxã€‚å®‰è£… cerbot-autoce"><meta name="keywords" content="soft,linux"><meta property="og:type" content="article"><meta property="og:title" content="Let&#39;s Encrypt å…è´¹å¥½ç”¨çš„ HTTPS è¯ä¹¦ ï¼ˆRaspberry piï¼‰"><meta property="og:url" content="https:&#x2F;&#x2F;ice.gs&#x2F;2016&#x2F;10&#x2F;08&#x2F;lets-encrypt-mian-fei-hao-yong-de-https-zheng-shu-raspberry-pi&#x2F;index.html"><meta property="og:site_name" content="ICE.GS"><meta property="og:description" content="Letâ€™s Encrypt è¢«ç§°ä¸ºä¸ªäººHTTPSçš„æœ€ä½³è§£å†³æ–¹æ¡ˆï¼Œå¾—åˆ°Mozillaã€CISCOã€Chromeã€Facebook ç­‰ä¼—å¤šä¼ä¸šç»„ç»‡çš„æ”¯æŒã€‚Letâ€™s Encrypt ä¹Ÿæä¾›ä¸€å¥—ç®€å•çš„HTTPSé…ç½®æ–¹æ¡ˆã€‚æœ¬æ–‡ç®€å•åˆ†äº«ä¸‹å®‰è£… Letâ€™s Encrypt HTTPSè¯ä¹¦è¿‡ç¨‹ï¼Œæœºå™¨ä¸ºRaspberry pi 3 ï¼Œç³»ç»Ÿä¸º Debian7ï¼ŒæœåŠ¡å™¨è½¯ä»¶ä¸ºNginxã€‚å®‰è£… cerbot-autoce"><meta property="og:locale" content="default"><meta property="og:image" content="https:&#x2F;&#x2F;ice.gs&#x2F;content&#x2F;images&#x2F;2016&#x2F;10&#x2F;-----2016-10-09---12-12-37.png"><meta property="og:image" content="https:&#x2F;&#x2F;ice.gs&#x2F;content&#x2F;images&#x2F;2016&#x2F;10&#x2F;-----2016-10-09---12-14-31.png"><meta property="og:updated_time" content="2017-05-16T07:33:04.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https:&#x2F;&#x2F;ice.gs&#x2F;content&#x2F;images&#x2F;2016&#x2F;10&#x2F;-----2016-10-09---12-12-37.png"><link rel="stylesheet" href="//cdn.staticfile.org/nprogress/0.2.0/nprogress.css"><link rel="stylesheet" href="//cdn.staticfile.org/highlight.js/9.15.10/styles/github-gist.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_405585_yuudmyqpo3q.css"><script src="//cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="/style.css"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?403460ed7637fb6c4a9e09a74e662ca0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><meta name="generator" content="Hexo 4.0.0"></head></html><body><script>NProgress.start()</script><div id="site-wrapper"><header class="header"><div class="header-wrapper"><a href="/"><img src="/image/logo.jpg" class="logo"></a><div class="social-wrapper"><a href="https://twitter.com/iggice" class="social twitter" target="_blank" rel="external"><span class="iconfont icon-twitter"></span> </a><a href="https://github.com/ggice" class="social github" target="_blank" rel="external"><span class="iconfont icon-github"></span> </a><a href="http://ggice.lofter.com/" class="social lofter" target="_blank" rel="external"><span class="iconfont icon-lofter"></span> </a><a href="https://dribbble.com/ggice" class="social dribbble" target="_blank" rel="external"><span class="iconfont icon-dribbble"></span> </a><a href="mailto:i@ice.gs" class="social email" target="_blank" rel="external"><span class="iconfont icon-email"></span> </a><a href="/atom.xml" class="social rss" target="_blank" rel="external"><span class="iconfont icon-rss"></span> </a><a href="#" class="social search-do" target="_blank" rel="external"><span class="iconfont icon-search"></span></a></div><div class="search-wrap"><div class="search-content animated fade-in"><p class="search-input"><span class="iconfont icon-search"></span> <input tabindex="1"></p><ul class="search-result"><div class="tags"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-os-X/" rel="tag">Mac os X</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/os/" rel="tag">os</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/others/" rel="tag">others</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/raspberry-pi/" rel="tag">raspberry pi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/soft/" rel="tag">soft</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-development/" rel="tag">web development</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-development%E6%8E%A8%E8%8D%90%E6%96%B9%E6%B3%95/" rel="tag">web developmentæ¨èæ–¹æ³•</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/work/" rel="tag">work</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E5%9D%97%E5%8A%A0%E8%BD%BD%E5%99%A8/" rel="tag">æ¨¡å—åŠ è½½å™¨</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E8%BE%91%E5%99%A8/" rel="tag">ç¼–è¾‘å™¨</a></li></ul></div></ul></div></div><nav class="header-nav"><a href="/" class="archives">home </a><a href="/tags/web-development/" class="archives">web development </a><a href="/tags/soft/" class="archives">soft </a><a href="/tags/os/" class="archives">os </a><a href="/archives" class="archives">archives </a><a href="/README/" class="archives">README</a></nav></div></header><script>NProgress.set(.4)</script><main id="main" role="main"><article id="post-lets-encrypt-mian-fei-hao-yong-de-https-zheng-shu-raspberry-pi" class="post article white-box article-type-post animated fade-in-top" itemscope itemprop="blogPost"><section class="post-header article-header"><h2 class="title"><a href="/2016/10/08/lets-encrypt-mian-fei-hao-yong-de-https-zheng-shu-raspberry-pi/">Let&#39;s Encrypt å…è´¹å¥½ç”¨çš„ HTTPS è¯ä¹¦ ï¼ˆRaspberry piï¼‰</a></h2><div class="subtitle"><time>Oct 8, 2016 </time><span class="tags"><span class="iconfont icon-tag"></span> <a class="tag-link" href="/tags/linux/" rel="tag">linux</a> / <a class="tag-link" href="/tags/soft/" rel="tag">soft</a></span></div></section><section class="content"><div class="article-entry" itemprop="articleBody"><p>Letâ€™s Encrypt è¢«ç§°ä¸ºä¸ªäººHTTPSçš„æœ€ä½³è§£å†³æ–¹æ¡ˆï¼Œå¾—åˆ°Mozillaã€CISCOã€Chromeã€Facebook ç­‰ä¼—å¤šä¼ä¸šç»„ç»‡çš„æ”¯æŒã€‚Letâ€™s Encrypt ä¹Ÿæä¾›ä¸€å¥—ç®€å•çš„HTTPSé…ç½®æ–¹æ¡ˆã€‚</p><p><img src="/content/images/2016/10/-----2016-10-09---12-12-37.png" alt></p><p>æœ¬æ–‡ç®€å•åˆ†äº«ä¸‹å®‰è£… Letâ€™s Encrypt HTTPSè¯ä¹¦è¿‡ç¨‹ï¼Œæœºå™¨ä¸ºRaspberry pi 3 ï¼Œç³»ç»Ÿä¸º Debian7ï¼ŒæœåŠ¡å™¨è½¯ä»¶ä¸ºNginxã€‚</p><h2 id="å®‰è£…-cerbot-auto"><a href="#å®‰è£…-cerbot-auto" class="headerlink" title="å®‰è£… cerbot-auto"></a>å®‰è£… cerbot-auto</h2><p>cerbot-auto æ˜¯ Letâ€™s Encrypt çš„è‡ªåŠ¨åŒ–å®‰è£…å·¥å…·ã€‚</p><pre><code>wget https://dl.eff.org/certbot-auto  
chmod a+x certbot-auto
</code></pre><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>å¾…å®‰è£…å®Œæˆä¹‹å</p><pre><code>./certbot-auto certonly --standalone -d x21.xyz -d center.x21.xyz
</code></pre><p>-d ä¹‹åæ˜¯è·Ÿéšé…ç½®åŸŸåï¼Œå­åŸŸåå¯ä½¿ç”¨å¤šä¸ª-d ï¼ŒLetâ€™s Encrypt ä¸æ”¯æŒæ³›åŸŸåæ‰€ä»¥è¦è®¾ç½®æ¯ä¸€ä¸ªå­åŸŸå, å›è½¦åå°†ä¼šå‡ºç°å›¾å½¢ç•Œé¢ï¼Œè¾“å…¥é‚®ç®±ç­‰è®¾ç½®ä¿¡æ¯ã€‚</p><p>æ³¨æ„ï¼š ä½¿ç”¨å‰è®°å¾—åœæ‰Nginxï¼Œå…¶ä»–å ç”¨80æˆ–è€…443ç«¯å£çš„ç¨‹åºä¹Ÿéœ€è¦åœæ‰ï¼Œcertbot-auto è®¤è¯éœ€è¦è¿™ä¸¤ä¸ªç«¯å£ã€‚</p><h2 id="é…ç½®nginx"><a href="#é…ç½®nginx" class="headerlink" title="é…ç½®nginx"></a>é…ç½®nginx</h2><p>center.x21.xyz åŸŸåçš„é…ç½®å®ä¾‹</p><pre><code>server {
    listen 80;
    listen [::]:80;
    server_name center.x21.xyz;
    return 301 https://$host$request_uri;
}
server {
    listen 443 ssl;
    listen [::]:443 ssl;
    server_name center.x21.xyz;

    ssl_certificate /path/fullchain.pem; #ç”Ÿæˆçš„fullchain.pem è·¯å¾„
    ssl_certificate_key /path/privkey.pem; #ç”Ÿæˆçš„privkey.pem è·¯å¾„
    ssl_session_timeout 1d;
    ssl_session_cache shared:SSL:50m;
    #ssl_session_tickets off;

    ssl_dhparam /etc/nginx/ssl/dhparam.pem;
    # dhparam.pem ç”Ÿæˆæ–¹æ³•
    # $ sudo mkdir /etc/nginx/ssl
    # $ sudo openssl dhparam -out /etc/nginx/ssl/dhparam.pem 2048

    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers &#39;ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-A    ES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-A    ES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:    AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS&#39;;
    ssl_prefer_server_ciphers on;

    add_header Strict-Transport-Security max-age=15768000;
    ssl_stapling on;
    ssl_stapling_verify on;

    resolver 8.8.8.8 8.8.4.4;

    location / {
            proxy_set_header   X-Real-IP $remote_addr;
            proxy_set_header   Host      $http_host;
            proxy_pass         http://127.0.0.1:9901;
    }

}
</code></pre><h2 id="HTTPS-é…ç½®æ–‡ä»¶ç”Ÿæˆå™¨"><a href="#HTTPS-é…ç½®æ–‡ä»¶ç”Ÿæˆå™¨" class="headerlink" title="HTTPS é…ç½®æ–‡ä»¶ç”Ÿæˆå™¨"></a>HTTPS é…ç½®æ–‡ä»¶ç”Ÿæˆå™¨</h2><p>Mozilla æœ‰ä¸€ä¸ªHTTPSé…ç½®æ–‡ä»¶çš„ç”Ÿæˆå™¨<a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/" target="_blank" rel="noopener">Mozilla SSL Configuration Generator</a></p><p>ä¸Šé¢çš„nginxä¾¿æ˜¯é…ç½®å€Ÿé‰´Mozilla SSL Configuration Generatorï¼Œä½†æ˜¯nginx version: nginx/1.6.2, ä¸€äº›ç‰¹æ€§å¹¶ä¸æ”¯æŒï¼Œåˆ å‡äº†ä¸€äº›é…ç½® (ä¸€äº›nginxé…ç½®å¹¶ä¸äº†è§£ç”¨é€”ğŸ˜­)ã€‚</p><h2 id="æµ‹è¯•HTTPSé…ç½®ï¼Œè¯„åˆ†"><a href="#æµ‹è¯•HTTPSé…ç½®ï¼Œè¯„åˆ†" class="headerlink" title="æµ‹è¯•HTTPSé…ç½®ï¼Œè¯„åˆ†"></a>æµ‹è¯•HTTPSé…ç½®ï¼Œè¯„åˆ†</h2><p><a href="https://www.ssllabs.com/ssltest/index.html" target="_blank" rel="noopener">Qualys SSL Labs</a>æä¾›äº†å…¨é¢çš„ SSL æ£€æµ‹å’Œè¯„çº§ï¼Œå¯ä»¥æ ¹æ®è¯„æµ‹æŠ¥å‘Šä¿®æ”¹HTTPSé…ç½®ã€‚</p><p>ä¸Šé¢çš„é…ç½®å·²ç»è·å¾—äº†A+</p><p><img src="/content/images/2016/10/-----2016-10-09---12-14-31.png" alt></p><h2 id="è‡ªåŠ¨æ›´æ–°è¯ä¹¦"><a href="#è‡ªåŠ¨æ›´æ–°è¯ä¹¦" class="headerlink" title="è‡ªåŠ¨æ›´æ–°è¯ä¹¦"></a>è‡ªåŠ¨æ›´æ–°è¯ä¹¦</h2><p>Letâ€™s Encrypt è¯ä¹¦çš„æœŸé™æ˜¯3ä¸ªæœˆï¼Œåˆ°æœŸä¹‹åéœ€è¦ç»­æœŸï¼Œå€ŸåŠ©cerbot-autoå·¥å…·å¯ä»¥å®ç°è‡ªåŠ¨æ›´æ–°ã€‚</p><p>ä½¿ç”¨ crontab é…ç½®è‡ªåŠ¨ä»»åŠ¡</p><pre><code>sudo crontab -e
</code></pre><p>æ·»åŠ ä»¥ä¸‹å†…å®¹</p><pre><code>56 0,3 * * * /usr/bin/certbot renew --quiet --no-self-upgrade
</code></pre><p>æ¯å¤©0ç‚¹å’Œ3ç‚¹æ‰§è¡Œä¸€æ¬¡æ›´æ–°è¯ä¹¦å‘½ä»¤ ï¼ˆcerbot-auto æ¨èæ¯å¤©æ£€æŸ¥ä¸¤æ¬¡ï¼‰</p></div></section><section id="gitalk-container"></section></article><script>NProgress.set(.6)</script></main><footer class="footer"><div class="footer-wrap"><div class="footer-link"><h3>LINKS</h3><p><a href="http://1x0.xyz/" target="_blank">Tian1x0</a> <a href="http://www.royalmice.com/hankzhou/" target="_blank">Hankzhou</a> <a href="http://sjydh.me/" target="_blank">è®¾è®¡æœ‰ç‚¹è´§</a> <a href="https://developers.google.com/web/fundamentals/" target="_blank">Web fundamentals</a></p></div><div class="footer-tags"><h3>TAGS</h3><div class="tags"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-os-X/" rel="tag">Mac os X</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/os/" rel="tag">os</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/others/" rel="tag">others</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/raspberry-pi/" rel="tag">raspberry pi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/soft/" rel="tag">soft</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-development/" rel="tag">web development</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-development%E6%8E%A8%E8%8D%90%E6%96%B9%E6%B3%95/" rel="tag">web developmentæ¨èæ–¹æ³•</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/work/" rel="tag">work</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E5%9D%97%E5%8A%A0%E8%BD%BD%E5%99%A8/" rel="tag">æ¨¡å—åŠ è½½å™¨</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E8%BE%91%E5%99%A8/" rel="tag">ç¼–è¾‘å™¨</a></li></ul></div></div><div class="footer-info"><div>Theme <span class="codename"><a href="https://github.com/GGICE/hexo-icer" target="_blank">icer</a></span> designed & coded by <a href="https://ice.gs/" target="_blank">GGICE</a></div><div>Copyright &copy; 2019, <a href="/">ICE.GS</a> . All rights reserved .</div></div></div></footer><script>NProgress.set(.8)</script></div><script src="//cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script><script>hljs.initHighlightingOnLoad()</script><script src="/js/main.js"></script><script src="/js/md5.js"></script><link rel="stylesheet" href="//cdn.staticfile.org/gitalk/1.5.0/gitalk.min.css"><script src="//cdn.staticfile.org/gitalk/1.5.0/gitalk.min.js"></script><script>document.querySelector("#gitalk-container")&&new Gitalk({clientID:"83a3413b0591f7c338af",clientSecret:"177f437bdc6573b374fa1ef51efb03e4c374d921",repo:"ICE.GS",owner:"GGICE",admin:["GGICE"],id:MD5(location.pathname),distractionFreeMode:!1}).render("gitalk-container")</script><script>NProgress.done()</script></body>